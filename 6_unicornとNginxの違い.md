# unicornとNginxについて
railsついて調べていると、unicornやNginx、Webサーバーやアプリケーションサーバー等、良く分からない言葉が頻発するので、そのあたりの仕組みを何となく理解できるようになるため、まとめるもの。

## 前提知識
### Ewbサーバーとは
HTTPに則り、HTMLや画像の情報を返してくれるもの。  
イメージ的には**静的なWebサイト（HTML,CSS,Javascript）に供されるもの**がこのサーバーで返される。
#### HTTPとは
- 「Hyper Text Transfer Protocol」の略
- WWW(World Wide Web)上でWebサーバとクライアントが、 HTML(Hyper Text Markup Language)で書かれた文書などの情報をやりとりする時に使われる通信手順(プロトコル)を意味する。

### アプリケーションサーバーとは
リクエストに対して、RubyやPHP等を実行し、動的な処理を実行後、静的な要素に変換し、Webサーバーに返すためのもの。  
（つまり、DBが必要ないサイトにアプリケーションサーバーは不必要）

### webサーバーとアプリケーションサーバーの連携
１　クライアントからWebサーバーに対し、リクエスト（url）が送られる。  
２　**Webサーバーから「アプリケーションサーバー」へリクエスト**が送られ、routes.rbを参考に処理。  
（DBがない場合、「２」から「４」は行われない。）  
３　DB通信等の処理が終了したら、Viewの**html.erbに情報を埋め込み、htmlを生成する**。  
４　動的処理（２〜３）により生成された**静的なhtmlをWebサーバーに返す**。  
５　webサーバーはリクエストに対して返ってきた静的な要素をクライアントに返す。  

### rails sをしたときに何が起きているのか
rackが起動し、railsアプリケーションが起動する。

#### rackとは
- rubyで書かれた様々なwebフレームワークとwebサーバーをrack自身の柔軟性によって繋いでくれるもの。
- つまり、rackはrubyで書かれたwebフレームワークをうまく動かすための**アプリケーションサーバ**。
- rails sでrailsを立ち上げたとき（ローカル環境時）、**webサーバが立ち上がっている訳ではなく**、rackによって**railsがうまくリクエストを返せるようになっている**。

## Nginxとは
- Webサーバーのひとつ。
- Nginxは、**rackと直接繋げない**ので、unicornを挟む必要がある。
### 最初から、「rack」と「unicorn」のみでいいのでは？
- Nginxはプロセス数が数千あるので、同時に**多くのクライアントにアクセスされても対応が可能**となる。

## unicornとは
- NginxとRackをうまく繋いでくれるWebサーバとアプリケーションサーバの中間のような存在。
- Webサーバとしても起動するので、UnicornとRackだけでRailsを動かすことも可能。
- しかし、プロセス数が少ないため、大勢のアクセスへの対処が難しい。
